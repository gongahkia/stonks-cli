# ============================================================================                                                                                              
# STONKS-CLI ENHANCEMENT TODO                                                                                                                                               
# Phase 1: Fast Mode + Charts (ship first)                                                                                                                                  
# Phase 2: Lightweight TUI                                                                                                                                                  
# Phase 3: Fundamental Data (free sources)                                                                                                                                  
# Phase 4: Portfolio Tracking                                                                                                                                               
# Phase 5: Alerts System                                                                                                                                                    
# Phase 6: Incremental Niche Features                                                                                                                                       
# ============================================================================                                                                                              
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 3E: SECTOR & CORRELATION                                                                                                                                            
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                            
Create new module `src/stonks_cli/analysis/correlation.py` with function `compute_correlation_matrix(tickers: list[str], dfs: dict[str, pd.DataFrame], days: int = 252) ->   pd.DataFrame` that computes pairwise Pearson correlation of daily returns                                                                                                   
Add `stonks correlation <TICKER1> <TICKER2> [TICKER3...]` command that displays correlation matrix as Rich table with values colored on gradient (green for low correlation  <0.3, yellow for medium, red for high >0.7)                                                                                                                                 
Create function `compute_beta(ticker_df: pd.DataFrame, benchmark_df: pd.DataFrame, days: int = 252) -> float` in correlation.py that computes beta coefficient of ticker     returns vs benchmark (default SPY)                                                                                                                                          
Add `--benchmark <TICKER>` flag to `stonks analyze` that includes beta vs specified benchmark in output                                                                     
Create constant dict `SECTOR_ETFS` in new module `src/stonks_cli/data/sectors.py` mapping sector names to representative ETFs: {"Technology": "XLK", "Healthcare": "XLV",    "Financials": "XLF", "Energy": "XLE", ...}                                                                                                                                  
Create function `identify_sector(ticker: str) -> str | None` in sectors.py that uses yfinance Ticker.info["sector"] to determine ticker's sector                            
Add `stonks sector <SECTOR_NAME>` command that displays performance of sector ETF with comparison to SPY, including: daily change, weekly change, monthly change, YTD change
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 4A: PORTFOLIO STORAGE                                                                                                                                               
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                            
Create new module `src/stonks_cli/portfolio/models.py` with dataclass `Position` containing fields: ticker, shares, cost_basis_per_share, purchase_date, notes (optional)   
Create dataclass `Portfolio` in models.py containing fields: positions (list[Position]), cash_balance (float), created_at (datetime), updated_at (datetime)                 
Create new module `src/stonks_cli/portfolio/storage.py` with function `get_portfolio_path() -> Path` that returns platform-appropriate path using platformdirs:              ~/.local/share/stonks-cli/portfolio.json (Linux), ~/Library/Application Support/stonks-cli/portfolio.json (macOS)                                                           
Create function `load_portfolio() -> Portfolio` in storage.py that reads portfolio.json and deserializes to Portfolio dataclass, returning empty Portfolio if file doesn't   exist                                                                                                                                                                       
Create function `save_portfolio(portfolio: Portfolio) -> None` in storage.py that serializes Portfolio to JSON and writes to portfolio.json with updated_at timestamp       
Create function `add_position(ticker: str, shares: float, cost_basis: float, date: date = None, notes: str = None) -> Position` in storage.py that appends new Position to   portfolio and saves, returning the created Position                                                                                                                         
Create function `remove_position(ticker: str, shares: float, sale_price: float) -> dict` in storage.py that reduces position shares using FIFO cost basis, removes Position  if shares reach zero, and returns dict with realized_gain_loss calculated from cost basis                                                                                   
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 4B: PORTFOLIO COMMANDS                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                              
Add `stonks portfolio add <TICKER> <SHARES> <COST_BASIS>` command that calls add_position and confirms with "Added 100 shares of AAPL at $150.00 cost basis"                
Add `--date <YYYY-MM-DD>` flag to `stonks portfolio add` to specify purchase date (defaults to today)                                                                       
Add `stonks portfolio remove <TICKER> <SHARES> <SALE_PRICE>` command that calls remove_position and displays realized gain/loss with percentage                             
Add `stonks portfolio show` command that displays all positions as Rich table with columns: Ticker, Shares, Cost Basis, Current Price, Market Value, Gain/Loss ($),          Gain/Loss (%), fetching current prices concurrently                                                                                                                         
Add `--total` flag to `stonks portfolio show` that appends summary row showing: Total Cost Basis, Total Market Value, Total Gain/Loss, Overall Return %                     
Create function `calculate_portfolio_allocation(portfolio: Portfolio, prices: dict[str, float]) -> dict[str, float]` in new module `src/stonks_cli/portfolio/analysis.py`    that computes percentage allocation per ticker                                                                                                                              
Add `stonks portfolio allocation` command that displays pie-chart-style breakdown using Rich table showing each position's percentage of total portfolio value              
Add `stonks portfolio history` command that reads from portfolio_history.jsonl (append-only log of all add/remove transactions) and displays transaction history            
Create function `log_transaction(action: str, ticker: str, shares: float, price: float, gain_loss: float = None)` in storage.py that appends JSON line to                    portfolio_history.jsonl with timestamp                                                                                                                                      
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 4C: PAPER TRADING                                                                                                                                                   
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                              
Create new module `src/stonks_cli/portfolio/paper.py` with function `init_paper_portfolio(starting_cash: float = 10000.0) -> Portfolio` that creates new Portfolio with      specified cash balance and empty positions, saved to paper_portfolio.json                                                                                                   
Add `stonks paper init` command with `--cash <AMOUNT>` flag (default 10000) that initializes paper trading portfolio                                                        
Add `stonks paper buy <TICKER> <SHARES>` command that checks paper portfolio has sufficient cash, fetches current price, deducts cost from cash_balance, adds Position, and  confirms trade with "Bought 10 AAPL @ $182.50 ($1825.00 total). Cash remaining: $8175.00"                                                                                   
Add `stonks paper sell <TICKER> <SHARES>` command that checks position exists with sufficient shares, fetches current price, adds proceeds to cash_balance, removes/reduces  Position, and displays realized gain/loss                                                                                                                                   
Add `stonks paper status` command that displays paper portfolio summary: cash balance, positions table with current values, total portfolio value, and overall P&L since     inception (comparing to initial cash)                                                                                                                                       
Create function `calculate_paper_performance(portfolio: Portfolio, initial_cash: float) -> dict` in paper.py returning total_value, total_return_pct, best_trade,            worst_trade, win_rate from transaction history                                                                                                                              
Add `stonks paper reset` command with confirmation prompt that deletes paper_portfolio.json and paper_history.jsonl to start fresh                                          
Add `stonks paper leaderboard` command that reads paper trading history and displays performance metrics: total return %, Sharpe ratio approximation, max drawdown, number   of trades, win rate                                                                                                                                                         
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 5A: ALERT CONFIGURATION                                                                                                                                             
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                              
Create new module `src/stonks_cli/alerts/models.py` with dataclass `Alert` containing fields: id (uuid), ticker, condition_type                                              (price_above/price_below/rsi_above/rsi_below/sma_cross_up/sma_cross_down), threshold (float), created_at, triggered_at (optional), enabled (bool)                           
Create new module `src/stonks_cli/alerts/storage.py` with function `get_alerts_path() -> Path` returning platform-appropriate path to alerts.json                           
Create function `load_alerts() -> list[Alert]` in storage.py that reads and deserializes alerts.json                                                                        
Create function `save_alert(alert: Alert) -> None` in storage.py that appends alert to alerts.json                                                                          
Create function `delete_alert(alert_id: str) -> bool` in storage.py that removes alert by ID and returns success status                                                     
Add `stonks alert add <TICKER> price-above <VALUE>` command that creates Alert with condition_type=price_above and saves, confirming with "Alert created: AAPL price above   $200.00 (ID: abc123)"                                                                                                                                                       
Add `stonks alert add <TICKER> price-below <VALUE>` command for price_below condition                                                                                       
Add `stonks alert add <TICKER> rsi-above <VALUE>` command for RSI threshold alerts (e.g., overbought at 70)                                                                 
Add `stonks alert add <TICKER> rsi-below <VALUE>` command for RSI threshold alerts (e.g., oversold at 30)                                                                   
Add `stonks alert list` command that displays all alerts as Rich table with columns: ID (truncated), Ticker, Condition, Threshold, Status (enabled/triggered), Created      
Add `stonks alert remove <ALERT_ID>` command that deletes alert and confirms removal                                                                                        
Add `stonks alert disable <ALERT_ID>` and `stonks alert enable <ALERT_ID>` commands to toggle alert enabled status without deleting                                         
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 5B: ALERT CHECKING & NOTIFICATION                                                                                                                                   
# ----------------------------------------------------------------------------                                                                                              
  
Create new module `src/stonks_cli/alerts/checker.py` with function `check_alert(alert: Alert, df: pd.DataFrame) -> bool` that evaluates alert condition against latest data, returning True if condition is met                                                                                                                                         
Implement condition evaluation in check_alert: price_above/below compares latest close to threshold, rsi_above/below computes 14-period RSI and compares to threshold       
Create function `check_all_alerts() -> list[tuple[Alert, bool]]` in checker.py that loads all enabled alerts, fetches required data (batched by ticker), checks each alert,  and returns list of (alert, triggered) tuples                                                                                                                               
Create function `notify_terminal_bell(alert: Alert) -> None` in new module `src/stonks_cli/alerts/notify.py` that prints alert message to stdout with Rich formatting and    sends terminal bell character (\a)                                                                                                                                          
Create function `log_alert_trigger(alert: Alert) -> None` in notify.py that appends triggered alert to alerts_log.jsonl with timestamp                                      
Create function `notify_webhook(alert: Alert, webhook_url: str) -> bool` in notify.py that POSTs JSON payload {ticker, condition, threshold, triggered_at, message} to       configured webhook URL, returning success status                                                                                                                            
Add `webhook_url` field to config.py AppConfig for alert webhook delivery (optional, None by default)                                                                       
Add `stonks alert check` command that runs check_all_alerts(), displays triggered alerts, sends notifications (bell + webhook if configured), and marks alerts as triggered 
Integrate alert checking into existing scheduler: add alert check step after analysis in scheduled runs, calling check_all_alerts and notify functions                      
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 5C: CONDITION-BASED ALERTS (ADVANCED)                                                                                                                               
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                              
Add `stonks alert add <TICKER> golden-cross` command that creates alert for 50-day SMA crossing above 200-day SMA                                                           
Add `stonks alert add <TICKER> death-cross` command that creates alert for 50-day SMA crossing below 200-day SMA                                                            
Implement SMA cross detection in check_alert: compute both SMAs, check if fast SMA crossed slow SMA by comparing current and previous day relationship                      
Add `stonks alert add <TICKER> volume-spike <MULTIPLIER>` command that triggers when daily volume exceeds N times the 20-day average volume (default 2x)                    
Implement volume spike detection in check_alert: compute 20-day volume SMA, compare latest volume to threshold multiple                                                     
Add `stonks alert add <TICKER> earnings-soon <DAYS>` command that triggers when ticker's next earnings date is within N days                                                
Implement earnings alert in check_alert by calling fetch_ticker_earnings_history and comparing next earnings date to current date                                           
Add `stonks alert add <TICKER> new-high-52w` command that triggers when price exceeds 52-week high                                                                          
Add `stonks alert add <TICKER> new-low-52w` command that triggers when price falls below 52-week low                                                                        
Implement 52-week high/low detection in check_alert using rolling 252-day max/min of close prices                                                                           
                                                                                                                                                                              
# ----------------------------------------------------------------------------                                                                                              
# PHASE 6: INCREMENTAL NICHE FEATURES                                                                                                                                       
# ----------------------------------------------------------------------------                                                                                              
                                                                                                                                                                              
Create function `fetch_dividend_info(ticker: str) -> dict` in new module `src/stonks_cli/data/dividends.py` that extracts from yfinance: dividend_yield, annual_dividend,    payout_ratio, ex_dividend_date, next_dividend_date, dividend_history (last 8 quarters)                                                                                      
Add `stonks dividend <TICKER>` command that displays dividend information as Rich panel: current yield, annual payment, payout ratio, ex-date countdown, and table of recent dividend history with payment dates and amounts                                                                                                                            
Add `stonks dividend calendar` command that scans configured watchlist tickers and displays upcoming ex-dividend dates for the next 30 days                                 
Create function `compute_earnings_implied_move(ticker: str) -> float` in earnings.py that calculates average absolute post-earnings move from historical data               
Add `--implied-move` flag to `stonks earnings --ticker <TICKER>` that displays the historically implied earnings move percentage                                            
Add `stonks movers` command that fetches daily performance of major indices (SPY, QQQ, DIA, IWM) and displays as compact table with daily change percentages                
Add `--sector` flag to `stonks movers` that shows sector ETF performance instead of indices (XLK, XLV, XLF, XLE, XLY, XLP, XLI, XLB, XLU, XLRE, XLC)                        
Create function `detect_unusual_volume(tickers: list[str], threshold: float = 2.0) -> list[dict]` in new module `src/stonks_cli/analysis/unusual.py` that identifies tickers with volume > threshold * 20-day average                                                                                                                                   
Add `stonks unusual` command that scans watchlist for unusual volume activity and displays flagged tickers with volume multiple and price change                            
